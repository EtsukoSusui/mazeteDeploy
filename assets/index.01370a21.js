var de=Object.defineProperty,ge=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var ue=Object.getOwnPropertySymbols;var he=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var re=(t,a,i)=>a in t?de(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i,Z=(t,a)=>{for(var i in a||(a={}))he.call(a,i)&&re(t,i,a[i]);if(ue)for(var i of ue(a))pe.call(a,i)&&re(t,i,a[i]);return t},V=(t,a)=>ge(t,me(a));import{u as W,a as ee,r,v as _e,b as S,j as l,c as e,A as ve,T as fe,d as Se,e as be,F as te,M as ie,B as q,f as ye,g as Ce,q as Fe,h as we,R as Ee,i as R,k as Ae,l as Ne}from"./vendor.05c149c7.js";const xe=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))m(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const v of s.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&m(v)}).observe(document,{childList:!0,subtree:!0});function i(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function m(o){if(o.ep)return;o.ep=!0;const s=i(o);fetch(o.href,s)}};xe();const T="https://mazete-api-dev.pechakucha.ai",ke=Se({stringify:t=>t.kana+t.label});function K(t){return new Promise(a=>setTimeout(a,t))}function Be(){const[t,a]=r.exports.useState([0,0]);return r.exports.useLayoutEffect(()=>{function i(){a([window.innerWidth,window.innerHeight])}return window.addEventListener("resize",i),i(),()=>window.removeEventListener("resize",i)},[]),t}const Ie=["\u30AD\u30E3\u30E9\u540D\u307E\u305F\u306F\u4F5C\u54C1\u540D\u3067\u3055\u304C\u3059","\u5834\u9762\u540D\u307E\u305F\u306F\u4F5C\u54C1\u540D\u3067\u3055\u304C\u3059"];function $e(){const t=W();ee();const[a,i]=r.exports.useState(1),[m,o]=r.exports.useState([]),[s,v]=r.exports.useState(null),[d,E]=r.exports.useState(!1),[y,A]=r.exports.useState([]),[b,$]=r.exports.useState([]),[D,O]=r.exports.useState([]),[N,h]=r.exports.useState([]),[C,x]=r.exports.useState([]),[k,p]=r.exports.useState(null),[Q,M]=Be();r.exports.useEffect(async()=>{let n=window.innerHeight;document.getElementById("character_select").style.height=n+"px";let u=sessionStorage.register_id||null,_=sessionStorage.background||null,g=sessionStorage.user_list||null;if(sessionStorage.removeItem("outline_data"),g&&o(JSON.parse(g)),_&&v(JSON.parse(_)),!u){u=_e();var j=JSON.stringify({register_id:u}),J={method:"post",url:`${T}/register_id`,headers:{"Content-Type":"application/json"},data:j};S(J).then(f=>{sessionStorage.setItem("register_id",u)}).catch(f=>{t("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})}),await K(1)}let I=JSON.stringify({user_id:u,search_query:"",chosen_chara_ids:"",chosen_world_ids:""}),c={method:"post",url:`${T}/get_chara_list`,headers:{"Content-Type":"application/json"},data:I};S(c).then(f=>{A(f.data.chara_list)}).catch(f=>{t("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})}),await K(1);let F=JSON.stringify({user_id:u,search_query:"",chosen_chara_ids:"",chosen_world_ids:""}),L={method:"post",url:`${T}/get_world_list`,headers:{"Content-Type":"application/json"},data:F};S(L).then(f=>{$(f.data.world_list)}).catch(f=>{t("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})}),await K(1);let w={method:"post",url:`${T}/get_autocomplete_chara`,headers:{"Content-Type":"application/json"},data:{}};S(w).then(f=>{h(f.data.auto_complete),x(f.data.auto_complete)}).catch(f=>{}),await K(1);let H={method:"post",url:`${T}/get_autocomplete_world`,headers:{"Content-Type":"application/json"},data:{}};S(H).then(f=>{O(f.data.auto_complete)}).catch(f=>{})},[]),r.exports.useEffect(()=>{s&&m.length>0?E(!0):E(!1)},[m,s]);const z=n=>{let u=m,_=y.filter(g=>g.chara_id==n)[0];if(u==null?void 0:u.map(g=>g.chara_id).includes(n)){for(let g=0;g<u.length;g++)u[g].chara_id===n&&(u.splice(g,1),g--);o([...u])}else u.length<3&&(u.push(_),o([...u]))},B=()=>{let n=sessionStorage.register_id||null,u=JSON.stringify({user_id:n,chosen_chara_ids:m.map(g=>g.chara_id).toString(),chosen_world_ids:[s.world_id].toString()}),_={method:"post",url:`${T}/generate_outline`,headers:{"Content-Type":"application/json"},data:u};S(_).then(g=>{sessionStorage.setItem("outline_id",g.data.outline_id),sessionStorage.setItem("background",JSON.stringify(s)),sessionStorage.setItem("user_list",JSON.stringify(m)),sessionStorage.removeItem("outline_data"),t("/synopsis",{state:{}})}).catch(g=>{t("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})},X=n=>{n.preventDefault();let u=sessionStorage.register_id||null,_=k,g=m.map(I=>I.chara_id).toString(),j="";s&&(j=[s.world_id].toString());let J=JSON.stringify({user_id:u,search_query:_,chosen_chara_ids:g,chosen_world_ids:j});if(a==1){let I={method:"post",url:`${T}/get_chara_list`,headers:{"Content-Type":"application/json"},data:J};S(I).then(c=>{A(c.data.chara_list)}).catch(c=>{t("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})}else{let I={method:"post",url:`${T}/get_world_list`,headers:{"Content-Type":"application/json"},data:J};S(I).then(c=>{$(c.data.world_list)}).catch(c=>{t("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})}},Y=n=>u=>{u.stopPropagation();let _=m;for(let g=0;g<_.length;g++)_[g].chara_id===n&&(_.splice(g,1),g--);o([..._])};return l("div",{className:"container",id:"character_select",children:[l("div",{className:"container-wrap",children:[l("div",{className:"common-header",children:[e("div",{className:"common-header-title01",children:"-\u4F5C\u54C1\u30EA\u30DF\u30C3\u30AF\u30B9-"}),e("div",{className:"common-header-title02",children:"\u30DE\u305C\u3066"})]}),l("div",{className:"preview",children:[l("div",{className:"preview-part",onClick:()=>{i(1),x(N),p(null)},children:[l("div",{className:"preview-img-part",children:[m==null?void 0:m.map(n=>e("div",{style:{backgroundImage:`url(${n.img_url})`},className:"avatar-preview",children:l("div",{className:"avatar-preview-close",onClick:Y(n.chara_id),children:[e("span",{}),e("span",{})]})},n.chara_id)),m.length==0&&e("div",{className:"avatar-preview",style:{backgroundImage:"url(/assets/image/default-avatar.png)"}})]}),e("div",{className:a===1?"preview-title-part active":"preview-title-part",children:"\u30AD\u30E3\u30E9"})]}),l("div",{className:"preview-part",onClick:()=>{i(2),x(D),p(null)},children:[e("div",{className:"preview-img-part",children:e("div",{style:{backgroundImage:`url(${s!=null?s.img_url:"/assets/image/point-bg.png"})`},className:s!=null?"world-preview":"world-none-preview"})}),e("div",{className:a===2?"preview-title-part active":"preview-title-part",children:"\u30B7\u30C1\u30E5\u30A8\u30FC\u30B7\u30E7\u30F3"})]})]}),l("div",{className:"point-select",children:[e("div",{className:"point-search",children:l("form",{onSubmit:X,children:[e(ve,{value:k,onChange:(n,u)=>{typeof u=="string"?p(u):u&&u.inputValue?p(u.inputValue):u&&u.label?p(u.label):p(u)},filterOptions:(n,u)=>ke(n,u),selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,options:C,getOptionLabel:n=>typeof n=="string"?n:n.label,renderOption:(n,u)=>e("li",V(Z({},n),{children:u.label})),renderInput:n=>e(fe,V(Z({},n),{label:"",placeholder:Ie[a-1],onChange:u=>{p(u.target.value)}}))}),e("button",{className:"search-btn",children:e("img",{src:"/assets/image/point-search.png",alt:""})})]})}),e("div",{className:"point-intro",children:"\u753B\u50CF\u306FBing\u306E\u691C\u7D22\u7D50\u679C\u3092\u3082\u3068\u306B\u8868\u793A\u3057\u3066\u3044\u307E\u3059"}),l("div",{className:"point-body",style:{height:`calc(${M}px - 305px)`},children:[a===1&&e("div",{className:"point-body-wrap",children:y==null?void 0:y.map((n,u)=>e("div",{style:{backgroundImage:`url(${n.img_url})`},onClick:()=>z(n.chara_id),className:`${m.map(_=>_.chara_id).includes(n.chara_id)?"active":""} character-item`,children:e("span",{})},u))}),a==2&&e("div",{className:"point-body-wrap",children:b==null?void 0:b.map((n,u)=>e("div",{style:{backgroundImage:`url(${n.img_url})`},className:`${(s==null?void 0:s.img_url)==n.img_url?"active":""} location-item`,onClick:_=>{v(n)},children:e("span",{})},u))})]})]})]}),l("button",{onClick:B,className:`character-add-btn ${d?"active":""}`,disabled:!d,children:[e("img",{src:"/assets/image/imgpsh_fullsize_anim.png",alt:""}),"\u30DE\u305C\u308B"]})]})}const ae="https://mazete-api-dev.pechakucha.ai";function Oe(){const[t,a]=r.exports.useState([0,0]);return r.exports.useLayoutEffect(()=>{function i(){a([window.innerWidth,window.innerHeight])}return window.addEventListener("resize",i),i(),()=>window.removeEventListener("resize",i)},[]),t}function Te(){const t=W(),a=r.exports.useRef(),[i,m]=r.exports.useState(!1),[o,s]=r.exports.useState(!0),[v,d]=r.exports.useState(""),[E,y]=r.exports.useState([]),[A,b]=r.exports.useState(null),[$,D]=r.exports.useState(10);Oe(),r.exports.useEffect(()=>{var C;let h=((C=a==null?void 0:a.current)==null?void 0:C.scrollHeight)+"px";D(h)},[v]),r.exports.useEffect(()=>{let h=window.innerHeight;document.getElementById("loading_synposis").style.height=h+"px";let C=sessionStorage.register_id||null,x=sessionStorage.outline_id||null,k=sessionStorage.background||null,p=sessionStorage.outline_data||null,Q=sessionStorage.user_images||null;b(JSON.parse(k));let M=JSON.stringify({user_id:C,outline_id:x});if(p)s(!1),y(JSON.parse(Q)),d(p);else{let z={method:"post",url:`${ae}/get_outline`,headers:{"Content-Type":"application/json"},data:M};S(z).then(B=>{B.data.generated&&B.data.outline&&!B.data.error?(s(!1),y(B.data.chara_img_urls),d(B.data.outline),sessionStorage.setItem("user_images",JSON.stringify(B.data.chara_img_urls))):t("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})}).catch(B=>{t("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})}},[]);const O=()=>{let h=sessionStorage.register_id||null,C=sessionStorage.outline_id||null;sessionStorage.setItem("outline_data",JSON.stringify(v));let x=JSON.stringify({user_id:h,outline_id:C}),k={method:"post",url:`${ae}/generate_story`,headers:{"Content-Type":"application/json"},data:x};S(k).then(p=>{t(`/talk/${p.data.story_id}`,{state:{}})}).catch(p=>{t("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})};r.exports.useEffect(()=>{a.current&&i&&a.current.focus()},[i]);const N=()=>{m(!1);let h=sessionStorage.register_id||null,C=sessionStorage.outline_id||null,x=JSON.stringify({user_id:h,outline_id:C,outline:v}),k={method:"post",url:`${ae}/update_outline`,headers:{"Content-Type":"application/json"},data:x};S(k).then(p=>{y(p.data.new_chara_img_urls)}).catch(p=>{t("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})};return l("div",{className:"container",id:"loading_synposis",children:[l("div",{className:"container-wrap",children:[e("div",{className:`ls-top ${i?"editing":""}`,children:e("div",{className:"ls-top-wrap",style:{backgroundImage:`url(${A==null?void 0:A.img_url}`,backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center"},children:e("div",{className:"ls-top-body",children:E.map((h,C)=>e("div",{className:"ls-top-item",style:{backgroundImage:`url(${h})`}},C))})})}),l("div",{className:"ls-main",children:[e("div",{className:"ls-main-title",children:"\u307E\u3048\u304C\u304D"}),l("div",{className:"ls-main-loading-text",children:[o&&l("div",{className:"ls-main-loading-part",children:[e("img",{src:"/assets/image/white-loading.gif",alt:""}),e("span",{children:"\u4E0B\u66F8\u304D\u6E96\u5099\u4E2D"})]}),!o&&e("textarea",{style:{height:$},ref:a,className:"ls-main-loading-wrap",value:v,disabled:!i,onChange:h=>{d(h.target.value)},onBlur:N}),o&&e("div",{className:"ls-main-loading-wrap"})]}),!i&&l("a",{className:"ls-main-edit-btn",onClick:()=>{a.current.focus(),m(!0)},children:[e("span",{children:"\u7DE8\u96C6"}),e("img",{src:"/assets/image/edit-icon.png",alt:""})]}),!i&&e("div",{className:"ls-main-making-btn-part",children:e("button",{onClick:O,className:o?"ls-main-making-btn":"ls-main-making-btn active",disabled:o,children:"\u3053\u306E\u4E16\u754C\u7DDA\u306B\u5165\u308B"})})]})]}),!i&&e("button",{className:"back-to-btn",onClick:()=>{let h=sessionStorage.user_list||null;t("/",{state:{user_list:h}})},children:e("img",{src:"/assets/image/back-to-img.png",alt:""})})]})}const G="https://mazete-api-dev.pechakucha.ai",De={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:260,bgcolor:"background.paper",borderRadius:"10px",p:4};function oe(t){return new Promise(a=>setTimeout(a,t))}function ze(){const[t,a]=r.exports.useState([0,0]);return r.exports.useLayoutEffect(()=>{function i(){a([window.innerWidth,window.innerHeight])}return window.addEventListener("resize",i),i(),()=>window.removeEventListener("resize",i)},[]),t}function Le(){const t=W(),[a,i]=r.exports.useState(!0),[m,o]=r.exports.useState(!0),[s,v]=r.exports.useState(null),[d,E]=r.exports.useState(0),[y,A]=r.exports.useState(null),[b,$]=r.exports.useState(null),[D,O]=r.exports.useState([]),[N,h]=r.exports.useState(!1),[C,x]=r.exports.useState(!1),[k,p]=r.exports.useState(!1),[Q,M]=ze();let{id:z}=be();const[B,X]=r.exports.useState(!1),Y=()=>{X(!0);let c=sessionStorage.register_id||null,F=JSON.stringify({user_id:c,story_id:z}),L={method:"post",url:`${G}/get_shared_message`,headers:{"Content-Type":"application/json"},data:F};S(L).then(w=>{t("/movie",{state:{message:w.data.message,movie_url:w.data.movie_url}})}).catch(w=>{t("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})};r.exports.useEffect(()=>{let c=sessionStorage.register_id||null,F=JSON.stringify({user_id:c,story_id:z}),L={method:"post",url:`${G}/get_story`,headers:{"Content-Type":"application/json"},data:F};S(L).then(w=>{if(w.data.generated&&!w.data.error){v(w.data);let H=w.data.story.map(f=>{const U=new Image;return U.src=f.chara_img_url,U});o(H),i(!1)}else t("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})}).catch(w=>{t("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})},[]),r.exports.useEffect(()=>{s&&n()},[s,d]),r.exports.useEffect(async()=>{if(s){let c=s.story;await oe(1),A(c[d].position)}},[b]);const n=()=>{let c=s.story;c[d]&&($(c[d].chara_img_url),c[d].multiple?(h(!0),O(c[d].content)):(h(!1),u(c[d].content)))},u=async c=>{p(!0);for(var F=0;F<c.length;)O([c.substring(0,F+1)]),F++,await oe(75);p(!1),s.story.length-1==d&&x(!0)},_=c=>{N&&(h(!1),u(c))},g=()=>{!k&&!N&&s.story.length-1>d&&E(d+1)},j=()=>{d===0&&t("/synopsis",{state:{}}),d!=0&&!k&&(E(d-1),x(!1))},J=c=>{c.preventDefault(),sessionStorage.removeItem("outline_id"),sessionStorage.removeItem("background"),sessionStorage.removeItem("user_list"),t("/",{state:{}})},I=c=>{if(!N)return;let F=sessionStorage.register_id||null;i(!0);let L=JSON.stringify({user_id:F,story_id:z,chosen_content:c}),w={method:"post",url:`${G}/generate_rest_story`,headers:{"Content-Type":"application/json"},data:L};S(w).then(H=>{let f=H.data.story_id,U=JSON.stringify({user_id:F,story_id:f}),ne={method:"post",url:`${G}/get_rest_story`,headers:{"Content-Type":"application/json"},data:U};S(ne).then(P=>{if(P.data.generated&&!P.data.error){s.story.splice(d+1,s.story.length-d-1),s.story=s.story.concat(P.data.story),v(s),_(c);let le=P.data.story.map(ce=>{const se=new Image;return se.src=ce.chara_img_url,se});o(le),i(!1)}else t("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})}).catch(P=>{t("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})}).catch(H=>{t("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})};return l(te,{children:[a&&e("div",{className:"container",id:"loading_adventure",children:e("div",{className:"container-wrap",children:l("div",{className:"la-wrap",children:[e("img",{src:"/assets/image/black-loading.gif",alt:""}),e("span",{children:"\u6E96\u5099\u4E2D"})]})})}),!a&&l("div",{className:"container",id:"adventure_state",style:{height:M},children:[l("div",{className:"container-wrap",onClick:g,children:[e("div",{className:"as-thumb",style:{backgroundImage:`url(${s==null?void 0:s.background_url})`},children:b&&e("img",{src:b,alt:"",className:`as-thumb-character ${y==0?"lb":y==1?"mb":"rb"}`})}),e("div",{className:"as-text",children:D.map((c,F)=>e("div",{className:`as-text-wrap ${k||N||C?"":"arrow"}`,style:{minHeight:`${N?"unset":"80px"}`},onClick:()=>{I(c)},children:c},F))})]}),e("button",{className:"back-to-btn",onClick:j,children:e("img",{src:d==0?"/assets/image/back-to-img.png":"/assets/image/back.png",alt:""})}),C&&l("div",{className:"text-select-btn-group",children:[e("a",{onClick:J,className:"final-btn",children:"\u30C8\u30C3\u30D7\u3078"}),e("a",{className:"final-btn",onClick:Y,children:"\u30B7\u30A7\u30A2"})]})]}),e(ie,{open:B,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:l(q,{sx:De,children:[e(q,{id:"modal-modal-title",variant:"h6",component:"h2",style:{textAlign:"center"},children:e("img",{src:"/assets/image/white-loading.gif",alt:""})}),e(ye,{id:"modal-modal-description",sx:{mt:2},children:"\u30B7\u30A7\u30A2\u7528\u306E\u52D5\u753B\u3092\u4F5C\u6210\u4E2D..."})]})})]})}function je(){const t=ee();return e("div",{className:"flex-center position-ref full-height full-width bg-white",children:e("div",{className:"message",style:{padding:"10px"},dangerouslySetInnerHTML:{__html:t.state.message}})})}const Je="https://mazete-api-dev.pechakucha.ai",He={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",borderRadius:"10px",p:4};function Re(){const t=W(),a=ee(),[i,m]=r.exports.useState(!1),[o,s]=r.exports.useState(a.state.message),v=()=>{m(!1)},d=b=>{b.preventDefault(),sessionStorage.removeItem("outline_id"),sessionStorage.removeItem("background"),sessionStorage.removeItem("user_list"),t("/",{state:{}})},E=()=>{Ce.exports.saveAs(a.state.movie_url,"video")},y=b=>{let $=sessionStorage.register_id||null;localStorage.setItem("movie_url",a.state.movie_url);let D=JSON.stringify({user_id:$,message:o,movie_url:a.state.movie_url}),O={method:"post",url:`${Je}/get_twitter_authenticate_url`,headers:{"Content-Type":"application/json"},data:D};S(O).then(N=>{localStorage.setItem("background",sessionStorage.background),localStorage.setItem("outline_data",sessionStorage.outline_data),localStorage.setItem("outline_id",sessionStorage.outline_id),localStorage.setItem("register_id",sessionStorage.register_id),localStorage.setItem("user_list",sessionStorage.user_list),localStorage.setItem("message",o),localStorage.setItem("movie_url",a.state.movie_url),window.location.href=N.data.authenticate_url}).catch(N=>{t("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})},A=b=>{b.preventDefault(),t(-1)};return l("div",{className:"container",id:"movie",children:[l("div",{className:"container-wrap",children:[e("div",{className:"movie-header",children:e("div",{className:"movie-header-title",children:"\u30B7\u30A7\u30A2"})}),l("div",{className:"movie_area",children:[l("div",{className:"movie_box",children:[e("span",{children:"\u52D5\u753B"}),e("div",{className:"movie_box_video",children:e("video",{id:"talk_movie",src:a.state.movie_url,autoPlay:!0,muted:!0,controls:!0})}),l("div",{className:"flex_box",children:[e("div",{className:"share_box",children:l("a",{onClick:()=>{m(!0)},children:[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"16",viewBox:"0 0 20 16",children:e("path",{fill:"#FFF",d:"M20 1.896c-.737.32-1.526.537-2.356.637.847-.5 1.5-1.291 1.805-2.233-.793.462-1.67.8-2.606.98C16.093.491 15.024 0 13.846 0 11.58 0 9.744 1.808 9.744 4.037c0 .317.033.625.106.921-3.412-.166-6.438-1.775-8.46-4.22-.352.595-.555 1.291-.555 2.029 0 1.4.729 2.637 1.83 3.362-.677-.016-1.313-.2-1.864-.504v.05c0 1.958 1.416 3.587 3.293 3.958-.343.092-.708.142-1.08.142-.263 0-.522-.025-.772-.075.521 1.604 2.039 2.77 3.836 2.804-1.403 1.084-3.175 1.73-5.099 1.73-.33 0-.657-.021-.979-.059C1.81 15.333 3.967 16 6.281 16c7.557 0 11.685-6.154 11.685-11.492 0-.175-.005-.35-.013-.52.801-.571 1.496-1.28 2.047-2.092z"})}),e("span",{children:"\u30C4\u30A4\u30FC\u30C8"})]})}),e("div",{className:"download_box",children:l("a",{onClick:E,children:[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"19",height:"22",viewBox:"0 0 19 22",children:e("path",{fill:"#FFF",d:"M9.484 15.139c.264 0 .528-.098.791-.362l3.262-3.134c.176-.176.283-.372.283-.635 0-.508-.42-.86-.898-.86-.254 0-.498.098-.674.293l-1.27 1.348-.605.752.127-1.445v-9.98c0-.538-.45-1.007-1.016-1.007-.566 0-1.025.47-1.025 1.006v9.98l.127 1.446-.606-.752-1.27-1.348c-.175-.195-.419-.293-.673-.293-.488 0-.898.352-.898.86 0 .263.107.459.283.635l3.262 3.134c.263.264.527.362.8.362zm5.616 6.23c2.177 0 3.33-1.152 3.33-3.31V8.576c0-2.158-1.153-3.31-3.33-3.31H12.53v2.236h2.364c.84 0 1.308.43 1.308 1.318v9.004c0 .88-.469 1.309-1.308 1.309H4.025c-.85 0-1.298-.43-1.298-1.309V8.82c0-.888.449-1.318 1.298-1.318h2.403V5.266H3.82c-2.168 0-3.33 1.152-3.33 3.31v9.483c0 2.158 1.162 3.31 3.33 3.31H15.1z"})}),e("span",{children:"\u4FDD\u5B58"})]})})]})]}),e("div",{className:"footer_box",children:e("div",{className:"recreate_box",children:e("div",{id:"back_button_footer_talk",onClick:d,children:e("span",{children:"\u30C8\u30C3\u30D7\u3078\u306B\u623B\u308B"})})})})]})]}),e("button",{className:"back-to-btn",onClick:A,children:e("img",{src:"/assets/image/back-to-img.png",alt:""})}),e(ie,{open:i,onClose:v,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:l(q,{sx:He,children:[e(q,{children:e("textarea",{className:"twitter-message",value:o,onChange:b=>{s(b.target.value)}})}),e(q,{display:"flex",justifyContent:"flex-end",children:e("div",{className:"share-btn",onClick:y,children:e("span",{children:"Twitter\u306B\u6295\u7A3F"})})})]})})]})}const Me="https://mazete-api-dev.pechakucha.ai";function Pe(){const t=W(),[a,i]=r.exports.useState(!0);return r.exports.useEffect(()=>{(async()=>{sessionStorage.setItem("background",localStorage.background),sessionStorage.setItem("outline_data",localStorage.outline_data),sessionStorage.setItem("outline_id",localStorage.outline_id),sessionStorage.setItem("register_id",localStorage.register_id),sessionStorage.setItem("user_list",localStorage.user_list),localStorage.removeItem("background"),localStorage.removeItem("outline_data"),localStorage.removeItem("outline_id"),localStorage.removeItem("register_id"),localStorage.removeItem("user_list");const{oauth_token:m,oauth_verifier:o}=Fe.parse(window.location.search);if(m&&o){let s=sessionStorage.register_id||null,v=JSON.stringify({user_id:s,oauth_token:m,oauth_verifier:o}),d={method:"post",url:`${Me}/tweet_movie`,headers:{"Content-Type":"application/json"},data:v};S(d).then(E=>{sessionStorage.removeItem("outline_id"),sessionStorage.removeItem("background"),sessionStorage.removeItem("user_list");let y=localStorage.message,A=localStorage.movie_url;E.data.error?alert("Twitter\u3078\u306E\u6295\u7A3F\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002"):alert("Twitter\u306B\u6295\u7A3F\u3057\u307E\u3057\u305F\u3002"),t("/movie",{state:{message:y,movie_url:A}})}).catch(E=>{t("/error",{state:{message:"\u30B9\u30C8\u30FC\u30EA\u30FC\u306E\u751F\u6210\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002<br/>\u6642\u9593\u3092\u304A\u3044\u3066\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}})})}})()},[]),e(te,{children:a&&e("div",{className:"container",id:"loading_adventure",children:e("div",{className:"container-wrap",children:l("div",{className:"la-wrap",children:[e("img",{src:"/assets/image/black-loading.gif",alt:""}),e("span",{children:"\u6E96\u5099\u4E2D"})]})})})})}function We(){return e(we,{children:l(Ee,{children:[e(R,{path:"/",element:e($e,{})}),e(R,{path:"/synopsis",element:e(Te,{})}),e(R,{path:"/talk/:id",element:e(Le,{})}),e(R,{path:"/movie",element:e(Re,{})}),e(R,{path:"/movie/upload_twitter",element:e(Pe,{})}),e(R,{path:"/error",element:e(je,{})})]})})}function qe(){return e(te,{children:e(We,{})})}Ae.render(e(Ne.StrictMode,{children:e(qe,{})}),document.getElementById("root"));
